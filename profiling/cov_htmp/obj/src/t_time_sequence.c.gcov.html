<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>LCOV - app.info - obj/src/t_time_sequence.c</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">obj/src</a> - t_time_sequence.c<span style="font-size: 80%;"> (source / <a href="t_time_sequence.c.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">app.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">71</td>
            <td class="headerCovTableEntry">77</td>
            <td class="headerCovTableEntryHi">92.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2011-03-29</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">5</td>
            <td class="headerCovTableEntry">5</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">26</td>
            <td class="headerCovTableEntry">34</td>
            <td class="headerCovTableEntryMed">76.5 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : #include &quot;t_time_sequence.h&quot;</a>
<a name="2"><span class="lineNum">       2 </span>                :            : #include &quot;t_pattern.h&quot;</a>
<span class="lineNum">       3 </span>                :            : 
<span class="lineNum">       4 </span>                :<span class="lineCov">        385 : int t_add_event_type(t_time_series* ts, char* event_name)</span>
<span class="lineNum">       5 </span>                :            :         /* TODO: check memory */
<span class="lineNum">       6 </span>                :            : {
<span class="lineNum">       7 </span>                :            :     int i;
<span class="lineNum">       8 </span>        [<span class="branchCov" title="Branch 1 was taken 373 times"> + </span><span class="branchCov" title="Branch 2 was taken 12 times"> + </span>]:<span class="lineCov">        385 :      if ( t_index_of(ts, event_name) != -1 ) return 2;</span>
<span class="lineNum">       9 </span>                :<span class="lineCov">         12 :     ts-&gt;num_event_types++;</span>
<span class="lineNum">      10 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span>]:<span class="lineCov">         12 :     if ( ts-&gt;num_event_types == 1 )</span>
<span class="lineNum">      11 </span>                :            :     {
<span class="lineNum">      12 </span>                :<span class="lineCov">          1 :         ts-&gt;allocated_num_event_types += PATTERN_ALLOCATE_BLOCK_SIZE;</span>
<span class="lineNum">      13 </span>                :<span class="lineCov">          1 :         ts-&gt;event_sign = ( char** ) malloc( ts-&gt;allocated_num_event_types * sizeof( char* ) );</span>
<span class="lineNum">      14 </span>                :<span class="lineCov">          1 :         ts-&gt;N = ( unsigned int * ) malloc( ts-&gt;allocated_num_event_types * sizeof( unsigned int ) );</span>
<span class="lineNum">      15 </span>                :<span class="lineCov">          1 :         memset( ts-&gt;N, 0, ts-&gt;allocated_num_event_types*sizeof( unsigned int ) );</span>
<span class="lineNum">      16 </span>                :<span class="lineCov">          1 :         ts-&gt;allocated_N = ( unsigned int * ) malloc( ts-&gt;allocated_num_event_types * sizeof( unsigned int ) );</span>
<span class="lineNum">      17 </span>                :<span class="lineCov">          1 :         ts-&gt;event_i = ( unsigned int ** ) malloc( ts-&gt;allocated_num_event_types * sizeof( unsigned int * ) );</span>
<span class="lineNum">      18 </span>                :            :     }
<span class="lineNum">      19 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 11 times"> + </span>]:<span class="lineCov">         12 :     if ( ts-&gt;allocated_num_event_types &lt; ts-&gt;num_event_types )</span>
<span class="lineNum">      20 </span>                :            :     {
<span class="lineNum">      21 </span>                :<span class="lineCov">          1 :         ts-&gt;allocated_num_event_types += PATTERN_ALLOCATE_BLOCK_SIZE;</span>
<span class="lineNum">      22 </span>                :<span class="lineCov">          1 :         ts-&gt;event_sign = ( char** ) realloc(ts-&gt;event_sign, ts-&gt;allocated_num_event_types * sizeof( char* ) );</span>
<span class="lineNum">      23 </span>                :<span class="lineCov">          1 :         ts-&gt;N = ( unsigned int * ) realloc(ts-&gt;N, ts-&gt;allocated_num_event_types * sizeof( unsigned int ) );</span>
<span class="lineNum">      24 </span>        [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">         11 :         for ( i = ts-&gt;allocated_num_event_types - PATTERN_ALLOCATE_BLOCK_SIZE; i &lt; ts-&gt;allocated_num_event_types; i++ ) ts-&gt;N[i]=0;</span>
<span class="lineNum">      25 </span>                :<span class="lineCov">          1 :         ts-&gt;allocated_N = ( unsigned int * ) realloc( ts-&gt;allocated_N, ts-&gt;allocated_num_event_types * sizeof( unsigned int ) );</span>
<span class="lineNum">      26 </span>                :<span class="lineCov">          1 :         ts-&gt;event_i = ( unsigned int ** ) realloc( ts-&gt;event_i, ts-&gt;allocated_num_event_types * sizeof( unsigned int * ) );</span>
<span class="lineNum">      27 </span>                :            :     }
<span class="lineNum">      28 </span>                :<span class="lineCov">         12 :     ts-&gt;event_sign[ ts-&gt;num_event_types - 1 ] = (char*) malloc( (strlen(event_name) + 1) * sizeof(char) );</span>
<span class="lineNum">      29 </span>                :<span class="lineCov">         12 :     strcpy( ts-&gt;event_sign[ ts-&gt;num_event_types - 1 ], event_name );</span>
<span class="lineNum">      30 </span>                :<span class="lineCov">        385 :     return 1;</span>
<a name="31"><span class="lineNum">      31 </span>                :            : }</a>
<span class="lineNum">      32 </span>                :            : 
<span class="lineNum">      33 </span>                :<span class="lineCov">        770 : int t_index_of(t_time_series* ts, char* event_name)</span>
<span class="lineNum">      34 </span>                :            : {
<span class="lineNum">      35 </span>                :            :   int i;
<span class="lineNum">      36 </span>        [<span class="branchCov" title="Branch 0 was taken 5430 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>]:<span class="lineCov">       5442 :   for ( i = 0; i &lt; ts-&gt;num_event_types; i++)</span>
<span class="lineNum">      37 </span>                :            :   {
<span class="lineNum">      38 </span>        [<span class="branchCov" title="Branch 0 was taken 758 times"> + </span><span class="branchCov" title="Branch 1 was taken 4672 times"> + </span>]:<span class="lineCov">       5430 :     if ( strcmp( ts-&gt;event_sign[i], event_name) == 0 ) return i;</span>
<span class="lineNum">      39 </span>                :            :   }
<span class="lineNum">      40 </span>                :<span class="lineCov">        770 :   return -1;</span>
<a name="41"><span class="lineNum">      41 </span>                :            : }</a>
<span class="lineNum">      42 </span>                :            : 
<span class="lineNum">      43 </span>                :<span class="lineCov">        385 : int t_add_event_ent(t_time_series* ts, char* event_name, unsigned int index)</span>
<span class="lineNum">      44 </span>                :            : {
<span class="lineNum">      45 </span>                :            :     int i;
<span class="lineNum">      46 </span>                :<span class="lineCov">        385 :     i = t_index_of(ts,  event_name );</span>
<span class="lineNum">      47 </span>                :<span class="lineCov">        385 :     ts-&gt;N[i]++;</span>
<span class="lineNum">      48 </span>                :            : 
<span class="lineNum">      49 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 373 times"> + </span>]:<span class="lineCov">        385 :     if ( ts-&gt;N[i] == 1 )</span>
<span class="lineNum">      50 </span>                :            :     {
<span class="lineNum">      51 </span>                :<span class="lineCov">         12 :         ts-&gt;allocated_N[i] = PATTERN_ALLOCATE_BLOCK_SIZE;</span>
<span class="lineNum">      52 </span>                :<span class="lineCov">         12 :         ts-&gt;event_i[i] = ( unsigned int * ) malloc( ts-&gt;allocated_N[i] * sizeof( unsigned int ) );</span>
<span class="lineNum">      53 </span>                :            :     }
<span class="lineNum">      54 </span>        [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchCov" title="Branch 1 was taken 353 times"> + </span>]:<span class="lineCov">        385 :     if ( ts-&gt;allocated_N[i] &lt;= ts-&gt;N[i] )</span>
<span class="lineNum">      55 </span>                :            :     {
<span class="lineNum">      56 </span>                :<span class="lineCov">         32 :         ts-&gt;allocated_N[i] += PATTERN_ALLOCATE_BLOCK_SIZE;</span>
<span class="lineNum">      57 </span>                :<span class="lineCov">         32 :         ts-&gt;event_i[i] = ( unsigned int * ) realloc(ts-&gt;event_i[i], ts-&gt;allocated_N[i] * sizeof( unsigned int ) );</span>
<span class="lineNum">      58 </span>                :            :         }
<span class="lineNum">      59 </span>                :<span class="lineCov">        385 :     ts-&gt;event_i[i][ ts-&gt;N[i] - 1 ] = index;</span>
<a name="60"><span class="lineNum">      60 </span>                :<span class="lineCov">        385 : }</span></a>
<span class="lineNum">      61 </span>                :            : 
<span class="lineNum">      62 </span>                :<span class="lineCov">          1 : int t_read_structs_from_file(t_time_series* ts, char* fname)</span>
<span class="lineNum">      63 </span>                :            : {
<span class="lineNum">      64 </span>                :            :     FILE* fp;
<span class="lineNum">      65 </span>                :<span class="lineCov">          1 :     unsigned int i, j, time, Namax=0;</span>
<span class="lineNum">      66 </span>                :            :     char c, buf1[1024], buf2[1024];
<span class="lineNum">      67 </span>                :            :     int buf[3];
<span class="lineNum">      68 </span>                :            :     t_pattern_list *tmp;
<span class="lineNum">      69 </span>                :<span class="lineCov">          1 :     ts-&gt;patterns = (t_pattern_list*) malloc( sizeof( t_pattern_list ) );</span>
<span class="lineNum">      70 </span>                :<span class="lineCov">          1 :     ts-&gt;patterns-&gt;next=NULL;</span>
<span class="lineNum">      71 </span>                :            :         
<span class="lineNum">      72 </span>        [<span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1 time"> + </span>]:<span class="lineCov">          1 :     if (! ( fp = fopen(fname, &quot;r&quot;) ) )</span>
<span class="lineNum">      73 </span>                :            :     {
<span class="lineNum">      74 </span>                :<span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">      75 </span>                :            :     }
<span class="lineNum">      76 </span>                :            :         
<span class="lineNum">      77 </span>                :            : 
<span class="lineNum">      78 </span>                :<span class="lineCov">          1 :     ts-&gt;allocated_num_event_types = 0;</span>
<span class="lineNum">      79 </span>                :<span class="lineCov">          1 :     ts-&gt;num_event_types = 0;</span>
<span class="lineNum">      80 </span>                :            : 
<span class="lineNum">      81 </span>                :<span class="lineCov">          1 :     fscanf(fp, &quot;Time\tEvent\n&quot;); </span>
<span class="lineNum">      82 </span>                :<span class="lineCov">          1 :     fscanf(fp, &quot;0\t:\n&quot;); </span>
<span class="lineNum">      83 </span>                :            :     
<span class="lineNum">      84 </span>        [<span class="branchCov" title="Branch 1 was taken 386 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span>]:<span class="lineCov">        386 :     for ( i = 0; !feof(fp); i++ )</span>
<span class="lineNum">      85 </span>                :            :     {
<span class="lineNum">      86 </span>                :<span class="lineCov">        386 :         fscanf(fp, &quot;%s\t%s\n&quot;, buf1, buf2);</span>
<span class="lineNum">      87 </span>                :<span class="lineCov">        386 :         time = atoi(buf1);</span>
<span class="lineNum">      88 </span>        [<span class="branchCov" title="Branch 0 was taken 1 time"> + </span><span class="branchCov" title="Branch 1 was taken 385 times"> + </span>]:<span class="lineCov">        386 :         if ( buf2[0] == '&amp;' )</span>
<span class="lineNum">      89 </span>                :            :         {
<span class="lineNum">      90 </span>                :<span class="lineCov">          1 :             ts-&gt;Nt = time;</span>
<span class="lineNum">      91 </span>                :<span class="lineCov">          1 :             break;</span>
<span class="lineNum">      92 </span>                :            :         }
<span class="lineNum">      93 </span>                :            :         
<span class="lineNum">      94 </span>                :<span class="lineCov">        385 :         t_add_event_type(ts, buf2);</span>
<span class="lineNum">      95 </span>                :<span class="lineCov">        385 :         t_add_event_ent(ts, buf2, time);</span>
<span class="lineNum">      96 </span>                :            :     }
<span class="lineNum">      97 </span>                :<span class="lineCov">          1 :     fclose(fp);</span>
<span class="lineNum">      98 </span>                :            : 
<span class="lineNum">      99 </span>                :            :         /* Make pattern structs */
<span class="lineNum">     100 </span>        [<span class="branchCov" title="Branch 0 was taken 12 times"> + </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">         13 :         for ( i = 0; i &lt; ts-&gt;num_event_types; i++ )</span>
<span class="lineNum">     101 </span>                :            :         {
<span class="lineNum">     102 </span>                :<span class="lineCov">         12 :                 Namax =  Namax &lt; ts-&gt;N[i] ? ts-&gt;N[i] : Namax;  </span>
<span class="lineNum">     103 </span>                :<span class="lineCov">         12 :                 buf[0] = i;</span>
<span class="lineNum">     104 </span>                :<span class="lineCov">         12 :                 tmp = add_pattern(ts-&gt;patterns, buf, 1);</span>
<span class="lineNum">     105 </span>                :<span class="lineCov">         12 :         tmp-&gt; pat.tree = (int*) malloc( sizeof(int) );</span>
<span class="lineNum">     106 </span>                :            :         
<span class="lineNum">     107 </span>                :<span class="lineCov">         12 :         tmp-&gt; pat.tree[0] = i;</span>
<span class="lineNum">     108 </span>                :<span class="lineCov">         12 :                 tmp-&gt; pat.tree_len = 1;</span>
<span class="lineNum">     109 </span>                :            :         
<span class="lineNum">     110 </span>                :<span class="lineCov">         12 :         tmp-&gt;pat.ind = ( double_series*) malloc( sizeof(double_series) * ts-&gt;N[i] );</span>
<span class="lineNum">     111 </span>                :<span class="lineCov">         12 :                 tmp-&gt;pat.N = ts-&gt;N[i];</span>
<span class="lineNum">     112 </span>        [<span class="branchCov" title="Branch 0 was taken 385 times"> + </span><span class="branchCov" title="Branch 1 was taken 12 times"> + </span>]:<span class="lineCov">        397 :                 for ( j = 0; j &lt; ts-&gt;N[i]; j++)</span>
<span class="lineNum">     113 </span>                :            :                 {
<span class="lineNum">     114 </span>                :<span class="lineCov">        385 :                         tmp-&gt;pat.ind[j].l = tmp-&gt;pat.ind[j].r = ts-&gt;event_i[i][j];</span>
<span class="lineNum">     115 </span>                :            :                 }
<span class="lineNum">     116 </span>                :            :         }
<span class="lineNum">     117 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 1 time"> + </span>]:<span class="lineCov">          1 :         if (logfac_table_size)</span>
<span class="lineNum">     118 </span>                :            :         {
<span class="lineNum">     119 </span>                :<span class="lineNoCov">          0 :                 fill_logfac_table( Namax+1 );</span>
<span class="lineNum">     120 </span>                :<span class="lineNoCov">          0 :                 fill_C_iz_N_po_k_table( Namax+1, Namax+1);</span>
<span class="lineNum">     121 </span>                :            :         }
<span class="lineNum">     122 </span>                :            :         
<span class="lineNum">     123 </span>                :<span class="lineCov">          1 :     return 1;</span>
<span class="lineNum">     124 </span>                :            : }
<span class="lineNum">     125 </span>                :            : 
<span class="lineNum">     126 </span>                :            : 
<a name="127"><span class="lineNum">     127 </span>                :            : </a>
<span class="lineNum">     128 </span>                :            : 
<span class="lineNum">     129 </span>                :<span class="lineCov">    5230392 : void t_choose_significance_levels(t_time_series *ts, double* alpha, int* Nmin, int n)</span>
<span class="lineNum">     130 </span>                :            : {
<span class="lineNum">     131 </span>                :            :         int i;
<span class="lineNum">     132 </span>                :<span class="lineCov">    5230392 :         *alpha = ts-&gt;alpha;</span>
<span class="lineNum">     133 </span>                :<span class="lineCov">    5230392 :         *Nmin = ts-&gt;Nmin;</span>
<span class="lineNum">     134 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 5230392 times"> + </span>]:<span class="lineCov">    5230392 :         if ( ts-&gt;nlevels )</span>
<span class="lineNum">     135 </span>                :            :         {
<span class="lineNum">     136 </span>[<span class="branchNoExec" title="Block containing branch 0 was never executed"> # </span><span class="branchNoExec" title="Block containing branch 1 was never executed"> # </span>][<span class="branchNoExec" title="Block containing branch 2 was never executed"> # </span><span class="branchNoExec" title="Block containing branch 3 was never executed"> # </span>]:<span class="lineNoCov">          0 :                 for ( i = 0; ( i &lt; ts-&gt;nlevels ) &amp;&amp; ( ts-&gt;levels[i].len &lt;= n ) ; i++ )</span>
<span class="lineNum">     137 </span>                :            :                 {
<span class="lineNum">     138 </span>                :<span class="lineNoCov">          0 :                         *alpha = ts-&gt;levels[i].alpha;</span>
<span class="lineNum">     139 </span>                :<span class="lineNoCov">          0 :                         *Nmin = ts-&gt;levels[i].Nmin;</span>
<span class="lineNum">     140 </span>                :            :                 }
<span class="lineNum">     141 </span>                :            :         }
<span class="lineNum">     142 </span>                :<span class="lineCov">    5230392 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.8</a></td></tr>
  </table>
  <br>

</body>
</html>
